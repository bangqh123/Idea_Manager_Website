{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\Web\\\\FrontEnd\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport { createContext, useReducer } from \"react\";\nimport { authReducer } from \"../reducers/authReducer\";\nimport { apiUrl, LOCAL_STORAGE_TOKEN_NAME } from \"./constants\";\nimport setAuthToken from \"../utils/setAuthToken\";\nimport axios from \"axios\";\nimport * as React from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nconst AuthContextProvider = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [authState, dispatch] = useReducer(authReducer, {\n    authLoading: true,\n    isAuthenticated: false,\n    user: '',\n    role: '',\n    Users: [],\n    accessToken: ''\n  });\n  const loadUser = async () => {\n    if (localStorage[LOCAL_STORAGE_TOKEN_NAME]) {\n      setAuthToken(localStorage[LOCAL_STORAGE_TOKEN_NAME]);\n    }\n    try {\n      const response = await axios.get(`${apiUrl}/auth`);\n      dispatch({\n        type: 'SET_AUTH',\n        payload: {\n          user: response.data.userToken.username,\n          role: response.data.userToken.role\n        }\n      });\n    } catch (error) {\n      localStorage.removeItem(LOCAL_STORAGE_TOKEN_NAME);\n      setAuthToken(null);\n      dispatch({\n        type: 'SET_AUTH',\n        payload: {\n          isAuthenticated: false,\n          user: null\n        }\n      });\n    }\n  };\n  React.useEffect(() => loadUser(), []);\n\n  //login\n  const loginUser = async userForm => {\n    try {\n      const response = await axios.post(`${apiUrl}/auth/login`, userForm);\n      console.log(\"data\", response.data.data.email);\n      if (response.data.token) localStorage.setItem(LOCAL_STORAGE_TOKEN_NAME, response.data.token);\n      if (response.data.data.email) {\n        dispatch({\n          type: 'SET_AUTH',\n          payload: {\n            user: response.data.data.email,\n            role: response.data.data.role\n          }\n        });\n      }\n      await loadUser();\n      return response.data;\n    } catch (error) {\n      if (error.response.data) return error.response.data;else return {\n        success: false,\n        message: error.message\n      };\n    }\n  };\n  const getAllUser = async () => {\n    try {\n      const response = await axios.get(`${apiUrl}/auth/users`);\n      console.log('data', response.data);\n      if (response.data.users) {\n        dispatch({\n          type: 'USERS_LOAD_SUCCESS',\n          payload: response.data.users\n        });\n      } else {\n        dispatch({\n          type: 'USERS_LOAD_FAIL'\n        });\n      }\n    } catch (error) {}\n  };\n  const register = async registerForm => {\n    const response = await axios.post(`${apiUrl}/auth/register`, registerForm);\n    console.log(\"register response\", response.data);\n    return response.data;\n  };\n  const deleteUser = async id => {\n    const response = await axios.delete(`${apiUrl}/auth/user/` + id);\n    console.log('response delete: ', response);\n  };\n\n  //context Data\n  const authContextData = {\n    authState,\n    loginUser,\n    getAllUser,\n    register,\n    deleteUser,\n    loadUser\n  };\n\n  //return provider\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: authContextData,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthContextProvider, \"QksYkV5TnYNy1tlhNjjrAvDh6YI=\");\n_c = AuthContextProvider;\nexport default AuthContextProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["createContext","useReducer","authReducer","apiUrl","LOCAL_STORAGE_TOKEN_NAME","setAuthToken","axios","React","jsxDEV","_jsxDEV","AuthContext","AuthContextProvider","_ref","_s","children","authState","dispatch","authLoading","isAuthenticated","user","role","Users","accessToken","loadUser","localStorage","response","get","type","payload","data","userToken","username","error","removeItem","useEffect","loginUser","userForm","post","console","log","email","token","setItem","success","message","getAllUser","users","register","registerForm","deleteUser","id","delete","authContextData","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Admin/Desktop/Web/FrontEnd/src/contexts/AuthContext.js"],"sourcesContent":["import { createContext, useReducer } from \"react\";\nimport { authReducer } from \"../reducers/authReducer\";\nimport { apiUrl, LOCAL_STORAGE_TOKEN_NAME } from \"./constants\";\nimport setAuthToken from \"../utils/setAuthToken\";\nimport axios from \"axios\";\nimport * as React from 'react'\n\n\nexport const AuthContext = createContext()\n\nconst AuthContextProvider = ({ children }) => {\n    const [authState, dispatch] = useReducer(authReducer, {\n        authLoading: true,\n        isAuthenticated: false,\n        user: '',\n        role: '',\n        Users: [],\n        accessToken: ''\n    })\n\n    const loadUser = async () => {\n        if (localStorage[LOCAL_STORAGE_TOKEN_NAME]) {\n            setAuthToken(localStorage[LOCAL_STORAGE_TOKEN_NAME])\n        }\n        try {\n            const response = await axios.get(`${apiUrl}/auth`)\n            dispatch({\n                type: 'SET_AUTH',\n                payload: { user: response.data.userToken.username, role: response.data.userToken.role }\n            })\n        } catch (error) {\n            localStorage.removeItem(LOCAL_STORAGE_TOKEN_NAME)\n            setAuthToken(null)\n            dispatch({\n                type: 'SET_AUTH',\n                payload: { isAuthenticated: false, user: null }\n            })\n        }\n    }\n    React.useEffect(() => loadUser(), [])\n\n    //login\n    const loginUser = async userForm => {\n        try {\n            const response = await axios.post(`${apiUrl}/auth/login`, userForm)\n            console.log(\"data\", response.data.data.email)\n            if (response.data.token)\n                localStorage.setItem(LOCAL_STORAGE_TOKEN_NAME, response.data.token)\n\n            if (response.data.data.email) {\n                dispatch({\n                    type: 'SET_AUTH',\n                    payload: { user: response.data.data.email, role: response.data.data.role }\n                })\n            }\n            await loadUser()\n            return response.data\n        } catch (error) {\n            if (error.response.data)\n                return error.response.data\n            else return { success: false, message: error.message }\n        }\n    }\n\n\n\n    const getAllUser = async () => {\n        try {\n            const response = await axios.get(`${apiUrl}/auth/users`)\n            console.log('data', response.data)\n            if (response.data.users) {\n                dispatch({ type: 'USERS_LOAD_SUCCESS', payload: response.data.users })\n            }\n            else {\n                dispatch({ type: 'USERS_LOAD_FAIL' })\n            }\n        } catch (error) {\n        }\n    }\n\n    const register = async (registerForm) => {\n        const response = await axios.post(`${apiUrl}/auth/register`, registerForm)\n        console.log(\"register response\", response.data)\n        return response.data\n\n    }\n\n    const deleteUser = async (id) => {\n        const response = await axios.delete(`${apiUrl}/auth/user/` + id)\n        console.log('response delete: ', response)\n    }\n\n    //context Data\n    const authContextData = { authState, loginUser, getAllUser, register, deleteUser, loadUser }\n\n    //return provider\n    return (\n        <AuthContext.Provider value={authContextData}>\n            {children}\n        </AuthContext.Provider>\n    )\n}\nexport default AuthContextProvider"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}